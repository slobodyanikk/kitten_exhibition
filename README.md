# Документация по приложению

## Требования
Для успешного запуска приложения убедитесь, что у вас установлены следующие зависимости:

- Python 3.10 или выше
- PostgreSQL 14 или выше
- Docker и Docker Compose (для запуска приложения в контейнерах)
  
## Описание запуска приложения

### Для запуска из GitHub репозитория 
1. Клонируйте репозиторий:
  ```
  git clone https://github.com/slobodyanikk/kitten_exhibition
  cd kitten_exhibition
  ```

2. Создайте виртуальное окружение:
   
  На Windows:
  ```
  python -m venv venv
  venv\Scripts\activate
  ```

3. Установите необходимые зависимости:
   
  Убедитесь, что файл requirements.txt находится в корневой папке проекта, затем выполните команду:
  ```
  pip install -r requirements.txt
  ```

4. Настройте базу данных:

  Проверьте файл **settings.py**, чтобы убедиться, что параметры подключения к базе данных корректны. Убедитесь, что база данных создана.

5. Примените миграции:

  ```
  python manage.py migrate
  ```

6. Запустите сервер:
  ```
  python manage.py runserver
  ```
  
  Теперь вы можете получить доступ к приложению по адресу **http://localhost:8000**.

  7. Для запуска тестов необходимо ввести команду для корневой папки проекта:
```
  pytest
  ```

### Для запуска из DockerHub репозитория

Информация о DockerHub репозитории по ссылке: https://hub.docker.com/repository/docker/slobodyanikk/kittens.

1. Загрузите Docker-образ приложения с Docker Hub:
```
docker pull your-dockerhub-username/kitten-expo:latest
```

2. Запустите контейнер с приложением:
```
docker run -d -p 8000:8000 your-dockerhub-username/kittens:latest
```
Эти команды загрузят образ с DockerHub и запустят контейнер, который будет доступен по порту 8000 (http://localhost:8000).

## Документация в формате Swagger
Документация API доступна по следующему адресу:
[Swagger API Documentation](http://localhost:8000/swagger/)

### Описание эндпоинтов

**1. Получение списка пород**
   
  URL: http://localhost:8000/api/breeds/
  
  Метод: GET
  
  Описание: Возвращает список всех пород, доступных в системе.

**2. Получение списка всех котят**
   
URL: http://localhost:8000/api/kittens/

Метод: GET

Описание: Возвращает список всех котят. Можно фильтровать по породе и минимальному рейтингу.

Параметры:

breed (необязательно) - ID породы

min_rating (необязательно) - минимальный средний рейтинг котенка

**3. Получение списка котят определенной породы**

URL: http://localhost:8000/api/kittens/?breed=<id>

Метод: GET

Описание: Возвращает список котят определенной породы, если указан параметр breed.

**4. Получение подробной информации о котенке**

URL: http://localhost:8000/api/kittens/<int:pk>/

Метод: GET

Описание: Возвращает детальную информацию о котенке с указанным id.

**5. Добавление информации о котенке**

URL: http://localhost:8000/api/kittens/add/

Метод: POST

Описание: Добавляет нового котенка. Только авторизованный пользователь может добавлять котят.

Пример запроса:
```
{
  "age": 4,
  "color": "black",
  "description": "cutty kitten",
  "breed": 2
}
```

**6. Изменение информации о котенке**

URL: http://localhost:8000/api/kittens/<int:pk>/edit/

Метод: PUT

Описание: Изменяет данные котенка, если текущий пользователь является владельцем этого котенка.

Пример запроса:
```
{
  "age": 5,
  "color": "gray",
  "description": "cutty kitten"
}
```

**7. Удаление информации о котенке**

URL: http://localhost:8000/api/kittens/<int:pk>/delete/

Метод: DELETE

Описание: Удаляет котенка. Только владелец котенка может удалить информацию о нем.

**8. JWT Авторизация пользователей**

Получение токена

URL: http://localhost:8000/api/token/

Метод: POST

Описание: Возвращает JWT токен для авторизации.

Пример запроса:
```
{
  "username": "user",
  "password": "password"
}
```

Обновление токена

URL: http://localhost:8000/api/token/refresh/

Метод: POST

Описание: Обновляет существующий JWT токен.

**Дополнительные возможности:**

**9. Оценка котят других пользователей**

URL: http://localhost:8000/api/ratings/add/

Метод: POST

Описание: Добавляет оценку котенку. Каждый пользователь может оценить котенка только один раз.

Пример запроса:
```
{
  "kitten": 1,
  "rating": 5
}
```

**10. Получение списка оценок**

URL: http://localhost:8000/api/ratings/

Метод: GET

Описание: Возвращает список всех оценок.

## Данные для проверки работоспособности приложения

1. Для проверки работоспособности приложения вам потребуются создать суперпользователя, чтобы появилась возможность создавать пользователей в административной панели. Также необходимо добавить записи в таблице пород.
Пример данных для добавления пользователей:
```
{
  "username": "user1",
  "password": "user1"
}
```
```
{
  "username": "user2",
  "password": "user2"
}
```

2. Авторизация:

POST запрос с JSON-данными:
```
{
  "username": "user1",
  "password": "user1"
}
```

3. Создание котенка:

POST запрос с JSON-данными:
```
{
  "breed": 1,
  "color": "black",
  "age": 2,
  "description": "Cute little kitten."
}
```

4. Добавив котенка, можно проверить работу слеудющих эндпоинтов с данными своего котенка котенка:

   Редактирование
```
{
  "breed": 1,
  "color": "gray",
  "age": 5,
  "description": "Cute edited little kitten."
}
```
   Оценка
  ```
  {
    "kitten": 1,
    "rating": 5
  }
  ```
   И удаление.

5. Авторизовавшись с помощью других пользовательских данных, можно попробовать изменить, оценить и удалить чужого котенка.
6. Также пользователям доступны такие запросы как:
    - Получение списка пород
    - Получение списка всех котят
    - Получение списка котят определенной породы по фильтру (фильтр - id породы из таблицы Breeds)
    - Получение подробной информации о котенке
